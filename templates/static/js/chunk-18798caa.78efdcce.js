(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-18798caa"],{"07ac":function(t,e,s){var a=s("23e7"),i=s("6f53").values;a({target:"Object",stat:!0},{values:function(t){return i(t)}})},"6b97":function(t,e,s){},"86a0":function(t,e,s){"use strict";s("6b97")},df21:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-container"},[t.fileChange&&1===t.status?s("div",{staticClass:"file_change"},[t._v("檔案有更動，請重新整理")]):t._e(),t.planChange&&1===t.status?s("div",{staticClass:"plan_change"},[t._v("測試計畫有更動")]):t._e(),s("div",{staticClass:"test_status"},[s("table",{style:t.shadow()},[t._m(0),s("tr",[s("td",[t._v(t._s(t.socketStatusList[t.status].statusText))]),s("td",[t._v(t._s(t.progress))])])]),s("el-button",{attrs:{type:t.socketStatusList[t.status].type,loading:t.wait||3===t.status,disabled:t.wait||0===t.allScript.length||3===t.status,plain:""},on:{click:t.startOrStopTest}},[t._v(t._s(t.socketStatusList[t.status].text))])],1),s("div",{staticClass:"test_url"},[s("label",[t._v("主要網址(取代)：")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.testVariable.mainUrl,expression:"testVariable.mainUrl"}],attrs:{type:"url",placeholder:"未填寫則使用腳本內的網址",title:"未填寫則使用腳本內的網址",disabled:1!==t.status},domProps:{value:t.testVariable.mainUrl},on:{input:[function(e){e.target.composing||t.$set(t.testVariable,"mainUrl",e.target.value)},t.variableChange]}})]),s("div",{attrs:{id:"addChangeVariable"}},[s("div",{staticClass:"speedTime"},[s("label",[t._v("測試執行速度(毫秒)：")]),s("el-slider",{attrs:{max:3e3,min:0,"format-tooltip":function(t){return t+" 毫秒"},"show-input":""},on:{change:t.changeSpeedTime},model:{value:t.speedTime,callback:function(e){t.speedTime=e},expression:"speedTime"}}),s("p",[t._v("PS:每一步驟間隔多久時間(毫秒)")])],1),s("div",{staticClass:"upload_text"},[s("div",[t._v("PS:上傳和運行中下載的檔案，在"),t.downloadsFolderPath?s("p",[t._v(t._s(t.downloadsFolderPath))]):t._e(),s("el-button",{attrs:{type:"info",disabled:0===t.status},on:{click:t.showFolderFiles}},[t._v("查看")]),t._v(" ; 運行完都將刪除。 ")],1)]),s("div",{staticClass:"add_upload"},[s("input",{ref:"uploadInput",staticClass:"uploadInput",attrs:{type:"file",multiple:""},on:{change:t.inputChange}}),s("el-button",{attrs:{type:"success",round:""},on:{click:t.uploadFiles}},[t._v("上傳檔案")]),s("el-button",{attrs:{disabled:1!==t.status},on:{click:t.addChangeVariable}},[t._v("增加變數欄位(取代)")])],1),t._l(t.testVariable.variable,(function(e){return[s("div",{key:""+e,staticClass:"variable"},[s("label",[t._v("變數名稱：")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.key,expression:"variable.key"}],attrs:{type:"text",placeholder:"腳本內的變數名稱，若無則不取代",title:"腳本內的變數名稱，若無則不取代",disabled:1!==t.status},domProps:{value:e.key},on:{input:[function(s){s.target.composing||t.$set(e,"key",s.target.value)},t.variableChange]}}),s("label",[t._v("變數的值：")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"variable.value"}],attrs:{type:"text",placeholder:"取代該變數名稱的新值",title:"取代該變數名稱的新值",disabled:1!==t.status},domProps:{value:e.value},on:{input:[function(s){s.target.composing||t.$set(e,"value",s.target.value)},t.variableChange]}}),s("el-button",{attrs:{disabled:1!==t.status},on:{click:function(s){return t.removeChangeVariable(e)}}},[t._v("刪除變數欄位")])],1)]}))],2),s("div",{staticClass:"datetime"},[s("label",[t._v("開始時間："+t._s(t.startDatetime))]),s("label",[t._v("結束時間："+t._s(t.endDatetime))])]),s("hr"),s("div",[s("el-button-group",[s("el-button",{class:t.selectedButton?"":"selected_button",on:{click:function(){t.selectedButton=0}}},[t._v("進度")]),s("el-button",{class:t.selectedButton?"selected_button":"",on:{click:function(){t.selectedButton=1}}},[t._v("畫面")])],1)],1),t.allScript.length?[t.selectedButton?[s("img",{attrs:{id:"video",src:"",alt:""}})]:[s("ol",t._l(t.allScript,(function(e){return s("li",{key:e.fileId},[t._v(" "+t._s(e.projectName)+" "),s("ol",t._l(e.suites,(function(a){return s("li",{key:a.suiteId},[t._v(" "+t._s(a.suiteName)+" "),s("ol",t._l(t.insertResult(e.fileId,e.projectId,a.suiteId,a.tests),(function(e){return s("li",{key:e.testId},[s("div",{class:e.result,attrs:{title:e.testName}},[s("div",[t._v(t._s(e.testName))]),s("div",["PASSED"===e.result?s("div",{staticClass:"el-icon-upload-success el-icon-circle-check"}):t._e(),t._v(" "+t._s(e.result)+" ")])])])})),0)])})),0)])})),0)]]:[s("h1",[t._v("沒有可以測試的項目")])]],2)},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("th",[t._v("運行狀態")]),s("th",[t._v("運行進度")])])}],n=s("d198"),o=s("7580"),l=(s("d3b7"),s("159b"),s("a15b"),s("d81d"),s("07ac"),s("13d5"),s("b0c0"),s("b680"),s("4d63"),s("ac1f"),s("2c3e"),s("25f0"),s("00b4"),s("a434"),{name:"SeleniumIdeRunWebTest",data:function(){return{startDatetime:"-----",endDatetime:"-----",selectedButton:0,fileChange:!1,planChange:!1,speedTime:1e3,downloadsFolderPath:"",testVariable:{mainUrl:"",variable:[]},wait:!0,allScript:[],status:0,progress:"0.00%",progressResult:{},socketStatusList:{0:{text:"連線中...",statusText:"-----",type:"primary",style:{color:"#1890ff"}},1:{text:"開始測試",statusText:"停止",type:"success",style:{color:"#13ce66"}},2:{text:"停止測試",statusText:"運行中...",type:"danger",style:{color:"#ff4949"}},3:{text:"等待停止",statusText:"停止中...",type:"danger",style:{color:"#ff4949"}},4:{text:"重置測試",statusText:"停止",type:"warning",style:{color:"#ffba00"}}}}},watch:{selectedButton:{handler:function(t){this.$socket.emit(t?this.$socketClientEmit.JOIN_ROOM.route:this.$socketClientEmit.LEAVE_ROOM.route)}}},beforeDestroy:function(){this.$socket.emit(this.$socketClientEmit.LEAVE_ROOM.route)},created:function(){this.getAllScript(),window.addEventListener("beforeunload",this.leaving)},methods:{variableChange:function(){1===this.status&&this.$socket.emit(this.$socketClientEmit.SERVER_ON_VARIABLE_CHANGE.route,this.testVariable)},insertResult:function(t,e,s,a){var i=this,n=[];return a.forEach((function(a){a["result"]=i.checkResult(t,e,s,a.testId),n.push(a)})),n},checkResult:function(t,e,s,a){return t in this.progressResult&&e in this.progressResult[t]&&s in this.progressResult[t][e]&&a in this.progressResult[t][e][s]?this.progressResult[t][e][s][a]:""},leaving:function(){this.$socket.disconnect()},getAllScript:function(){var t=this;return Object(o["a"])(Object(n["a"])().mark((function e(){return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.wait=!0,t.$request(t.$serverRoute.TEST_CASES.route).then((function(e){void 0!==e&&(t.allScript=e,t.connectSocket(),t.$request(t.$serverRoute.TEST_STATUS.route).then((function(e){void 0!==e&&(t.updateTestInfo(e),t.wait=!1)})))}));case 2:case"end":return e.stop()}}),e)})))()},changeSpeedTime:function(){this.$socket.emit(this.$socketClientEmit.SERVER_ON_SPEED_TIME.route,this.speedTime)},showFolderFiles:function(){var t=this;this.$request(this.$serverRoute.SHOW_FOLDER_FILES.route).then((function(e){void 0!==e&&t.$swal.fire({type:"info",title:"".concat(t.downloadsFolderPath,"裡面的檔案如下"),html:'<ul style="text-align: left; list-style-type: decimal">'.concat(e.map((function(t){return"<li>".concat(t," </li>")})).join(""),"</ul>"),width:"fit-content",customClass:{html:"text-left"}})}))},inputChange:function(){var t=this,e=this.$refs.uploadInput.files;if(e.length){var s=Object.values(e),a=s.reduce((function(t,e){return t.append(e.name,e),t}),new FormData);this.$swal.fire({title:"確定上傳檔案嗎?",html:"<p>你將要上傳以下的檔案</p>".concat(s.map((function(t){return"<p>".concat(t.name,"<p>")})).join("")),icon:"success",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"確定, 上傳!",cancelButtonText:"取消"}).then((function(e){e.isConfirmed&&t.$request(t.$serverRoute.UPLOAD_FILES_FOR_TEST.route,a).then((function(e){void 0!==e&&(t.$message.info(e),t.showFolderFiles())}))})),this.$refs.uploadInput.value=""}},uploadFiles:function(){this.$refs.uploadInput.click()},connectSocket:function(){var t=this;this.$socket.removeAllListeners(),this.$socket.on(this.$socketClientOn.SERVER_EMIT_TEST_STATUS.route,(function(e){return t.updateTestInfo(e)})),this.$socket.on(this.$socketClientOn.SERVER_EMIT_TEST_PLAN_CHANGE.route,(function(){t.planChange=!0})),this.$socket.on(this.$socketClientOn.SERVER_EMIT_SPEED_TIME.route,(function(e){t.speedTime=parseInt(e)})),this.$socket.on(this.$socketClientOn.SERVER_EMIT_SIDE_FILES_CHANGE.route,(function(){t.fileChange=!0})),this.$socket.on(this.$socketClientOn.SERVER_EMIT_TEST_SCREENSHOT.route,(function(e){t.selectedButton&&new Blob([e],{type:"image/jpeg"}).text().then((function(t){document.getElementById("video").src="data:image/jpeg;base64,"+t}))})),this.$socket.on(this.$socketClientOn.SERVER_EMIT_RESET.route,(function(e){t.$request(t.$serverRoute.TEST_CASES.route).then((function(e){void 0!==e&&(t.allScript=e,t.fileChange=!1,t.planChange=!1,t.selectedButton=0)}))})),this.$socket.on(this.$socketClientOn.SERVER_EMIT_VARIABLE_CHANGE.route,(function(e){t.testVariable=e}))},updateTestInfo:function(t){this.speedTime=void 0!==t.speedTime?t.speedTime:this.speedTime,this.downloadsFolderPath=t.downloadsFolderPath?t.downloadsFolderPath:"",this.testVariable=t.testVariable?t.testVariable:this.testVariable,this.startDatetime=t.startDatetime?t.startDatetime:"-----",this.endDatetime=t.endDatetime?t.endDatetime:"-----",this.progress="".concat(t.progress.toFixed(2),"%"),this.progressResult=t.progressResult,this.status=t.status},startOrStopTest:function(){var t=this;return Object(o["a"])(Object(n["a"])().mark((function e(){return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.wait=!0,1!==t.status){e.next=10;break}if(""!==t.testVariable.mainUrl&&!t.isValidUrl(t.testVariable.mainUrl)){e.next=7;break}return e.next=5,t.$request(t.$serverRoute.START_TEST_CASES.route,{testCases:t.allScript,testVariable:t.testVariable});case 5:e.next=8;break;case 7:t.$message.error("該網址有問題：".concat(t.testVariable.mainUrl));case 8:e.next=18;break;case 10:if(2!==t.status){e.next=15;break}return e.next=13,t.$request(t.$serverRoute.STOP_TEST_CASES.route);case 13:e.next=18;break;case 15:if(4!==t.status){e.next=18;break}return e.next=18,t.$request(t.$serverRoute.TEST_RESET.route);case 18:t.wait=!1;case 19:case"end":return e.stop()}}),e)})))()},isValidUrl:function(t){var e=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|localhost|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+#]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return e.test(t)},shadow:function(){return{"text-shadow":"".concat(this.socketStatusList[this.status].style.color," 0.1vw 0.1vw 0.2vw")}},addChangeVariable:function(){1===this.status&&(this.testVariable.variable.push({key:"",value:""}),this.variableChange())},removeChangeVariable:function(t){1===this.status&&(this.testVariable.variable.splice(this.testVariable.variable.indexOf(t),1),this.variableChange())}}}),r=l,u=(s("86a0"),s("2877")),c=Object(u["a"])(r,a,i,!1,null,"7c7dbcac",null);e["default"]=c.exports}}]);