(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-45e18065"],{"276d":function(e,t,n){"use strict";n("a6e9")},"9da0":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("el-button",{staticStyle:{"margin-bottom":"20px"},attrs:{loading:e.downloadLoading,disabled:0===e.multipleSelection.length,type:"primary",icon:"el-icon-document"},on:{click:function(t){return e.downloadFiles()}}},[e._v(" 下載選擇的檔案(Zip) ")]),n("el-button",{staticStyle:{"margin-bottom":"20px"},attrs:{id:"multiDelete",loading:e.deleteLoading,disabled:0===e.multipleSelection.length,type:"danger",icon:"el-icon-document"},on:{click:function(t){return e.deleteFiles()}}},[e._v(" 刪除選擇的檔案 ")]),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.reportsLoading,expression:"reportsLoading"}],ref:"multipleTable",attrs:{data:e.reports,"element-loading-text":"拼命加载中",height:"calc(80vh)",border:"",fit:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",align:"center"}}),n("el-table-column",{attrs:{align:"center",label:"Id",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.id)+" ")]}}])}),n("el-table-column",{attrs:{label:"Name"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("a",{staticClass:"view_one_file",attrs:{href:e.oneAllureFileUrl(t.row.name),target:"_blank"}},[e._v(e._s(t.row.name))])]}}])}),n("el-table-column",{attrs:{align:"center",label:"autotestVideo"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"info"},on:{click:function(n){return e.showTestVideo(t.row.name)}}},[e._v(" 查看自動化測試錄影檔 ")])]}}])}),n("el-table-column",{attrs:{align:"center",label:"finishCount",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.progress.finishCount)+" ")]}}])}),n("el-table-column",{attrs:{align:"center",label:"totalCount",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.progress.totalCount)+" ")]}}])}),n("el-table-column",{attrs:{align:"center",label:"finishRate",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"rate",style:e.background_hsl(t.row.progress.finishRate,!1)},[e._v(" "+e._s(t.row.progress.finishRate.toFixed(1).replace(/\.0$/,""))+" "),100===t.row.progress.finishRate?n("div",{staticClass:"el-icon-upload-success el-icon-circle-check"}):e._e()])]}}])}),n("el-table-column",{attrs:{align:"center",label:"passRate",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"rate",style:e.background_hsl(t.row.progress.passRate,!0)},[e._v(" "+e._s(t.row.progress.passRate.toFixed(1).replace(/\.0$/,""))+" "),100===t.row.progress.passRate?n("div",{staticClass:"el-icon-upload-success el-icon-circle-check"}):e._e()])]}}])})],1),n("el-dialog",{staticStyle:{"padding-bottom":"5vh","padding-top":"5vh"},attrs:{width:"65%",top:"5vh",center:!0,title:""+e.testCaseDateTime+e.videoName,visible:e.dialogFormVisible,"before-close":e.closeDialog},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[n("div",[n("video",{staticStyle:{width:"100%"},attrs:{controls:"",src:e.videoSrc,type:"video/mp4"}},[n("track",{ref:"subtitle",attrs:{label:e.videoName,kind:"subtitles",src:e.subtitleSrc,srclang:"def"}})])]),n("el-button",{on:{click:function(t){return e.changeTreeExpandStatus(!0)}}},[e._v("全展開")]),n("el-button",{on:{click:function(t){return e.changeTreeExpandStatus(!1)}}},[e._v("全閉合")]),n("el-input",{attrs:{placeholder:"篩選關鍵字"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),n("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.downloadVideoLoading,expression:"downloadVideoLoading"}],ref:"tree",attrs:{"element-loading-text":"下載中...",data:e.testCases,"default-expand-all":"","filter-node-method":e.filterNode},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.data;return[o.children.length?n("span",[e._v(e._s(o.label))]):n("div",{staticClass:"videoButtonsRow"},[n("button",{class:e.videoName==="("+o.label+")"?"selectVideo":"",on:{click:function(t){return e.fetchVideoAndSubtitleSrc(o.path,o.label)}}},[e._v(e._s(o.label))]),n("div",[n("button",{on:{click:function(t){return e.downloadVideoAndSubtitle(o)}}},[e._v("下載影片和字幕(分開)")]),n("button",{on:{click:function(t){return e.downloadMergeVideoSubtitle(o)}}},[e._v("下載影片和字幕(合併)")])])])]}}])})],1)],1)},a=[],i=n("d198"),r=n("7580"),c=(n("4de4"),n("d3b7"),n("99af"),n("159b"),n("d81d"),n("b0c0"),{name:"SeleniumIdeViewAndDownload",data:function(){return{reports:[],reportsLoading:!0,multipleSelection:[],downloadLoading:!1,deleteLoading:!1,dialogFormVisible:!1,testCases:[],filterText:"",testCaseDateTime:"",videoName:"",videoSrc:"",subtitleSrc:"",downloadVideoLoading:!1}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},created:function(){this.fetchHistory(),this.connectSocket()},methods:{oneAllureFileUrl:function(e){return"".concat(this.$origin,"/").concat(this.$serverRoute.VIEW_ALLURE.route,"/").concat(e)},downloadVideoAndSubtitle:function(e){var t=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var o,a;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.downloadVideoLoading=!0,o=encodeURIComponent(t.testCaseDateTime),a=encodeURIComponent(e.path),n.next=5,t.$downloadFileOrZip(["".concat(t.$serverRoute.TEST_CASE_VIDEO.route,"/").concat(o,"/").concat(a),"".concat(t.$serverRoute.TEST_CASE_SUBTITLE.route,"/").concat(o,"/").concat(a)],"".concat(t.testCaseDateTime,"_").concat(e.path,".zip"));case 5:t.downloadVideoLoading=!1;case 6:case"end":return n.stop()}}),n)})))()},downloadMergeVideoSubtitle:function(e){var t=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var o,a;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.downloadVideoLoading=!0,o=encodeURIComponent(t.testCaseDateTime),a=encodeURIComponent(e.path),n.next=5,t.$downloadFileOrZip(["".concat(t.$serverRoute.TEST_CASE_MERGE_VIDEO_SUBTITLE.route,"/").concat(o,"/").concat(a)]);case 5:t.downloadVideoLoading=!1;case 6:case"end":return n.stop()}}),n)})))()},closeDialog:function(e){this.videoSrc="",this.subtitleSrc="",this.videoName="",e()},fetchVideoAndSubtitleSrc:function(e,t){var n=this;this.videoName="(".concat(t,")");var o=encodeURIComponent(this.testCaseDateTime),a=encodeURIComponent(e);this.videoSrc="".concat(this.$origin).concat(this.$serverRoute.TEST_CASE_VIDEO.route,"/").concat(o,"/").concat(a),this.subtitleSrc="".concat(this.$origin).concat(this.$serverRoute.TEST_CASE_SUBTITLE.route,"/").concat(o,"/").concat(a),this.$refs.subtitle.track.mode="hidden",this.$nextTick((function(){n.$refs.subtitle.track.mode="showing"}))},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},changeTreeExpandStatus:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;(n||this.$refs.tree.$children).forEach((function(n){n.$children.length&&t.changeTreeExpandStatus(e,n.$children),n.$refs.node&&n.expanded!==e&&n.$refs.node.click()}))},background_hsl:function(e,t){return{"background-color":100===e?"rgb(0, 200, 0)":t?"rgba(200, 0, 0, ".concat(1-e/110,")"):"rgba(50, 50, 50, ".concat(1-e/110,")")}},fetchHistory:function(){var e=this;return Object(r["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.reportsLoading=!0,t.next=3,e.$request("".concat(e.$serverRoute.REPORT_HISTORY.route));case 3:e.reports=t.sent,e.reportsLoading=!1;case 5:case"end":return t.stop()}}),t)})))()},connectSocket:function(){var e=this;this.$socket.removeAllListeners(),this.$socket.on(this.$socketClientOn.SERVER_EMIT_TEST_RESULT_CHANGE.route,(function(t){e.reports=t}))},handleSelectionChange:function(e){this.multipleSelection=e},deleteFiles:function(){var e=arguments,t=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var o,a;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=e.length>0&&void 0!==e[0]?e[0]:void 0,t.deleteLoading=!0,n.next=4,t.$deleteFiles(t.$serverRoute.DELETE_ALLURES.route,(o?[o]:t.multipleSelection).map((function(e){return e.name})));case 4:if(a=n.sent,!a){n.next=9;break}return n.next=8,t.$request("".concat(t.$serverRoute.REPORT_HISTORY.route));case 8:t.reports=n.sent;case 9:t.deleteLoading=!1;case 10:case"end":return n.stop()}}),n)})))()},downloadFiles:function(){var e=arguments,t=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var o;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=e.length>0&&void 0!==e[0]?e[0]:void 0,t.downloadLoading=!0,n.next=4,t.$downloadFileOrZip((o?[o]:t.multipleSelection).map((function(e){return"".concat(t.$serverRoute.DOWNLOAD_ALLURE.route,"/").concat(e.name)})),"allure_report_".concat(t.$nowDatetimeFormat(),".zip"));case 4:t.$refs.multipleTable.clearSelection(),t.downloadLoading=!1;case 6:case"end":return n.stop()}}),n)})))()},showTestVideo:function(e){var t=this;this.$request("".concat(this.$serverRoute.TEST_CASES_VIDEO.route,"/").concat(e)).then((function(n){void 0!==n&&(t.testCaseDateTime=e,t.testCases=n,t.dialogFormVisible=!0)}))}}}),s=c,l=(n("276d"),n("2877")),d=Object(l["a"])(s,o,a,!1,null,"35a23600",null);t["default"]=d.exports},a6e9:function(e,t,n){}}]);